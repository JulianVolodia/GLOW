// GLOWCore.js r1.1 - http://github.com/empaempa/GLOW
var GLOW=function(){var b={},a={},d=-1;b.currentContext={};b.registerContext=function(d){a[d.id]=d;b.enableContext(d)};b.getContextById=function(d){if(a[d])return a[d];console.error("Couldn't find context id "+d+", returning current with id "+b.currentContext.id);return b.currentContext};b.enableContext=function(a){b.currentContext=typeof a==="string"?getContextById(a):a;GL=b.GL=b.currentContext.GL};b.uniqueId=function(){return++d};return b}(),GL={};
GLOW.Context=function(){function b(a){a===void 0&&(a={});this.id=a.id!==void 0?a.id:GLOW.uniqueId();this.alpha=a.alpha!==void 0?a.alpha:!0;this.depth=a.depth!==void 0?a.depth:!0;this.antialias=a.antialias!==void 0?a.antialias:!0;this.stencil=a.stencil!==void 0?a.stencil:!1;this.premultipliedAlpha=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0;this.preserveDrawingBuffer=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1;this.width=a.width!==void 0?a.width:window.innerWidth;this.height=
a.height!==void 0?a.height:window.innerHeight;this.cache=new GLOW.Cache;if(a.context)this.GL=a.context,GLOW.registerContext(this);else{try{this.domElement=document.createElement("canvas"),this.GL=this.domElement.getContext("experimental-webgl",{alpha:this.alpha,depth:this.depth,antialias:this.antialias,stencil:this.stencil,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer}),this.domElement.width=this.width,this.domElement.height=this.height}catch(d){console.error("GLOW.Context.construct: "+
d)}GLOW.registerContext(this);this.enableCulling(!0,{frontFace:GL.CCW,cullFace:GL.BACK});this.enableDepthTest(!0,{func:GL.LEQUAL,write:!0,zNear:0,zFar:1});this.enableBlend(!1);this.setupClear({clearBits:GL.COLOR_BUFFER_BIT|GL.DEPTH_BUFFER_BIT});this.setupViewport({x:0,y:0,width:this.width,height:this.height});this.clear()}}b.prototype.setupClear=function(a){var d=a.depth!==void 0?Math.min(1,Math.max(0,a.depth)):1;GL.clearColor(a.red!==void 0?Math.min(1,Math.max(0,a.red)):0,a.green!==void 0?Math.min(1,
Math.max(0,a.green)):0,a.blue!==void 0?Math.min(1,Math.max(0,a.blue)):0,a.alpha!==void 0?Math.min(1,Math.max(0,a.alpha)):1);GL.clearDepth(d);this.clearBits=a.clearBits!==void 0?a.clearBits:this.clearBits;return this};b.prototype.clear=function(a){if(a===void 0)a=this.clearBits;GL.clear(a);return this};b.prototype.enableBlend=function(a,d){a?(GL.enable(GL.BLEND),d&&this.setupBlend(d)):GL.disable(GL.BLEND);return this};b.prototype.setupBlend=function(a){a.equationRGB?(a.equationAlpha&&GL.blendEquationSeparate(a.equationRGB,
a.equationAlpha),a.srcRGB&&GL.blendFuncSeparate(a.srcRGB,a.dstRGB,a.srcAlpha,a.dstAlpha)):(a.equation&&GL.blendEquation(a.equation),a.src&&GL.blendFunc(a.src,a.dst));return this};b.prototype.enableDepthTest=function(a,d){a?(GL.enable(GL.DEPTH_TEST),d&&this.setupDepthTest(d)):GL.disable(GL.DEPTH_TEST);return this};b.prototype.setupDepthTest=function(a){a.func!==void 0&&GL.depthFunc(a.func);a.write!==void 0&&GL.depthMask(a.write);a.zNear!==void 0&&a.zFar!==void 0&&a.zNear<=a.zFar&&GL.depthRange(Math.max(0,
Math.min(1,a.zNear)),Math.max(0,Math.min(1,a.zFar)));return this};b.prototype.enablePolygonOffset=function(a,d){a?(GL.enable(GL.POLYGON_OFFSET_FILL),d&&this.setupPolygonOffset(d)):GL.disable(GL.POLYGON_OFFSET_FILL);return this};b.prototype.setupPolygonOffset=function(a){a.factor&&a.units&&GL.polygonOffset(a.factor,a.units)};b.prototype.enableStencilTest=function(a,d){a?(GL.enable(GL.STENCIL_TEST),d&&this.setupStencilTest(d)):GL.disable(GL.STENCIL_TEST);return this};b.prototype.setupStencilTest=function(a){a.func&&
a.funcFace?GL.stencilFuncSeparate(a.funcFace,a.func,a.funcRef,a.funcMask):a.func&&GL.stencilFunc(a.func,a.funcRef,a.funcMask);a.mask&&a.maskFace?GL.stencilMaskSeparate(a.maskFace,a.mask):a.mask&&GL.stencilMask(a.mask);a.opFail&&a.opFace?GL.stencilOpSeparate(a.opFace,a.opFail,a.opZfail,a.opZpass):a.opFail&&GL.stencilOp(a.opFail,a.opZfail,a.opZpass);return this};b.prototype.enableCulling=function(a,d){a?(GL.enable(GL.CULL_FACE),d&&this.setupCulling(d)):GL.disable(GL.CULL_FACE);return this};b.prototype.setupCulling=
function(a){try{a.frontFace&&GL.frontFace(a.frontFace),a.cullFace&&GL.cullFace(a.cullFace)}catch(d){console.error("GLOW.Context.setupCulling: "+d)}return this};b.prototype.enableScissor=function(a,d){a?(GL.enable(GL.SCISSOR_TEST),d&&this.setupScissor(d)):GL.disable(GL.SCISSOR_TEST);return this};b.prototype.setupScissor=function(a){try{GL.scissor(a.x,a.y,a.width,a.height)}catch(d){console.error("GLOW.Context.setupScissorTest: "+d)}return this};b.prototype.setupViewport=function(a){var a=a!==void 0?
a:{},d=a.x!==void 0?a.x:0,c=a.y!==void 0?a.y:0,e=this.width=a.width!==void 0?a.width:window.innerWidth,a=this.height=a.height!==void 0?a.height:window.innerHeight;this.GL.viewport(d,c,e,a);return this};return b}();
GLOW.Compiler=function(){var b={},a=[];b.compile=function(d){var c,e=a.length,j;for(c=0;c<e;c++)if(j=a[c],d.vertexShader===j.vertexShader&&d.fragmentShader===j.fragmentShader)break;c===e?(c=b.linkProgram(b.compileVertexShader(d.vertexShader),b.compileFragmentShader(d.fragmentShader)),a.push({vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,program:c})):c=j.program;e=b.createUniforms(b.extractUniforms(c),d.data);j=b.createAttributes(b.extractAttributes(c),d.data,d.usage,d.interleave);var g=
b.interleaveAttributes(j,d.interleave),f=d.elements,h=GL.TRIANGLES,i=d.usage?d.usage:{},k=i.elements;if(d.triangles)f=d.triangles,k=i.triangles;else if(d.triangleStrip)f=d.triangleStrip,h=GL.TRIANGLE_STRIP,k=i.triangleStrip;else if(d.triangleFan)f=d.triangleFan,h=GL.TRIANGLE_FAN,k=i.triangleFan;else if(d.points)f=d.points,h=GL.POINTS,k=i.points;else if(d.lines)f=d.lines,h=GL.LINES,k=i.lines;else if(d.lineLoop)f=d.lineLoop,h=GL.LINE_LOOP,k=i.lineLoop;else if(d.lineStrip)f=d.lineStrip,h=GL.LINE_STRIP,
k=i.lineStrip;f=b.createElements(f,h,k);return new GLOW.CompiledData(c,e,j,g,f,d)};b.compileVertexShader=function(a){var c;c=GL.createShader(GL.VERTEX_SHADER);c.id=GLOW.uniqueId();GL.shaderSource(c,a);GL.compileShader(c);GL.getShaderParameter(c,GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileVertexShader: "+GL.getShaderInfoLog(c));return c};b.compileFragmentShader=function(a){var c;c=GL.createShader(GL.FRAGMENT_SHADER);c.id=GLOW.uniqueId();GL.shaderSource(c,a);GL.compileShader(c);GL.getShaderParameter(c,
GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileFragmentShader: "+GL.getShaderInfoLog(c));return c};b.linkProgram=function(a,c){var e;e=GL.createProgram();e.id=GLOW.uniqueId();GL.attachShader(e,a);GL.attachShader(e,c);GL.linkProgram(e);GL.getProgramParameter(e,GL.LINK_STATUS)||console.error("GLOW.Compiler.linkProgram: Could not initialise program");return e};b.extractUniforms=function(a){for(var c={},e,b=0;;){e=GL.getActiveUniform(a,b);if(e!==null&&e!==-1&&e!==void 0)e={name:e.name.split("[")[0],
size:e.size,type:e.type,location:GL.getUniformLocation(a,e.name.split("[")[0]),locationNumber:b},c[e.name]=e;else break;b++}return c};b.extractAttributes=function(a){for(var c,e=0,b={};;){c=GL.getActiveAttrib(a,e);if(c!==null&&c!==-1&&c!==void 0)c={name:c.name,size:c.size,type:c.type,location:GL.getAttribLocation(a,c.name),locationNumber:e},b[c.name]=c;else break;e++}a.highestAttributeNumber=e-1;return b};b.createUniforms=function(a,c){var e,b={},g,f,h=0;for(e in a)g=a[e],f=g.name,c[f]===void 0?console.warn("GLOW.Compiler.createUniforms: missing declaration for uniform "+
f):c[f]instanceof GLOW.Uniform?b[f]=c[f]:(b[f]=new GLOW.Uniform(g,c[f]),b[f].type===GL.SAMPLER_2D&&b[f].data.init(h++));return b};b.createAttributes=function(a,c,e,b){var g,f,h,i={},b=b!==void 0?b:{},e=e!==void 0?e:{};for(g in a)f=a[g],h=f.name,c[h]===void 0?console.warn("GLOW.Compiler.createAttributes: missing declaration for attribute "+h):i[h]=c[h]instanceof GLOW.Attribute?c[h]:new GLOW.Attribute(f,c[h],e[h]!==void 0?e[h]:void 0,b[h]!==void 0?b[h]:!0);return i};b.interleaveAttributes=function(a,
c){var c=c!==void 0?c:{},e,b,g,f,h;b=0;var i=[];for(e in a)c[e]!==void 0&&c[e]!==!1&&(b=Math.max(b-1,c[e])+1);for(e in a)c[e]===void 0&&(c[e]=b);for(h in c)c[h]!==!1&&(i[c[h]]===void 0&&(i[c[h]]=[]),i[c[h]].push(a[h]));var k,l;e=0;for(b=i.length;e<b;e++)if(i[e]!==void 0){g=k=0;for(f=i[e].length;g<f;g++)if(k+i[e][g].size*4>255){console.warn("GLOW.Compiler.interleaveAttributes: Stride owerflow, moving attributes to new interleave index. Please check your interleave setup!");l=i.length;for(i[l]=[];g<
f;)i[l].push(i[e][g]),i[e].splice(g,1),f--}else k+=i[e][g].size*4}l={};e=0;for(b=i.length;e<b;e++)if(i[e]!==void 0){k="";g=0;for(f=i[e].length;g<f;g++)k+=g!==f-1?i[e][g].name+"_":i[e][g].name;l[k]=new GLOW.InterleavedAttributes(i[e])}for(h in c)c[h]!==!1&&delete a[h];return l};b.createElements=function(a,c,e){var b;a===void 0?console.error("GLOW.Compiler.createElements: missing 'elements' in supplied data. Quitting."):a instanceof GLOW.Elements?b=a:(a instanceof Uint16Array||(a=new Uint16Array(a)),
b=new GLOW.Elements(a,c,e!==void 0?e:GL.STATIC_DRAW));return b};return b}();
GLOW.CompiledData=function(){function b(a,d,c,b,j,g){this.program=a;this.uniforms=d!==void 0?d:{};this.attributes=c!==void 0?c:{};this.interleavedAttributes=b!==void 0?b:{};this.elements=j;g=g!==void 0?g:{};this.preDrawCallback=g.preDrawCallback;this.postDrawCallback=g.postDrawCallback;this.blend=g.blend;this.stencil=g.stencil}b.prototype.clone=function(a){var d=new GLOW.CompiledData,a=a!==void 0?a:{},c;for(c in this.uniforms)a[c]?(d.uniforms[c]=new GLOW.Uniform(this.uniforms[c],a[c]),d.uniforms[c].type===
GL.SAMPLER_2D&&d.uniforms[c].data.init(this.uniforms[c].data.textureUnit)):d.uniforms[c]=this.uniforms[c];for(var b in this.attributes)d.attributes[b]=a[b]?new GLOW.Attribute(this.attributes[b],a[b]):this.attributes[b];for(var j in this.interleavedAttributes)d.interleavedAttributes[j]=a[j]?new GLOW.InterleavedAttributes(a[j]):this.interleavedAttributes[j];d.elements=a.elements?new GLOW.Elements(a.elements):this.elements;d.program=a.program?a.program:this.program;d.blend=a.blend?a.blend:this.blend;
d.stencil=a.stencil?a.stencil:this.stencil;d.preDrawCallback=a.preDrawCallback?a.preDrawCallback:this.preDrawCallback;d.postDrawCallback=a.postDrawCallback?a.postDrawCallback:this.postDrawCallback;return d};return b}();
GLOW.Cache=function(){function b(){this.highestAttributeNumber=-1;this.uniformByLocation=[];this.attributeByLocation=[];this.textureByLocation=[];this.programId=this.elementId=-1;this.active=!0}b.prototype.programCached=function(a){if(this.active){if(a.id===this.programId)return!0;this.programId=a.id}return!1};b.prototype.setProgramHighestAttributeNumber=function(a){var d=this.highestAttributeNumber;this.highestAttributeNumber=a.highestAttributeNumber;return a.highestAttributeNumber-d};b.prototype.uniformCached=
function(a){if(this.active){if(this.uniformByLocation[a.locationNumber]===a.id)return!0;this.uniformByLocation[a.locationNumber]=a.id}return!1};b.prototype.attributeCached=function(a){if(this.active){if(this.attributeByLocation[a.locationNumber]===a.id)return!0;this.attributeByLocation[a.locationNumber]=a.id}return!1};b.prototype.textureCached=function(a){if(this.active){if(this.textureByLocation[a.textureUnit]===a.id)return!0;this.textureByLocation[a.textureUnit]=a.id}return!1};b.prototype.elementsCached=
function(a){if(this.active){if(a.id===this.elementId)return!0;this.elementId=a.id}return!1};b.prototype.clear=function(){this.highestAttributeNumber=-1;this.uniformByLocation.length=0;this.attributeByLocation.length=0;this.textureByLocation.length=0;this.programId=this.elementId=-1};return b}();
GLOW.FBO=function(){function b(a){a=a!==void 0?a:{};this.id=GLOW.uniqueId();this.width=a.width!==void 0?a.width:window.innerWidth;this.height=a.height!==void 0?a.height:window.innerHeight;var d=a.wrapS!==void 0?a.wrapS:GL.CLAMP_TO_EDGE,b=a.wrapT!==void 0?a.wrapT:GL.CLAMP_TO_EDGE,e=a.magFilter!==void 0?a.magFilter:GL.LINEAR,j=a.minFilter!==void 0?a.minFilter:GL.LINEAR,g=a.format!==void 0?a.format:GL.RGBA,f=a.depth!==void 0?a.depth:!0,a=a.stencil!==void 0?paramaters.stencil:!1;this.textureUnit=-1;this.frameBuffer=
GL.createFramebuffer();this.renderBuffer=GL.createRenderbuffer();this.texture=GL.createTexture();this.viewport={x:0,y:0,width:this.width,height:this.height};try{GL.bindTexture(GL.TEXTURE_2D,this.texture),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_S,d),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_T,b),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MAG_FILTER,e),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MIN_FILTER,j),GL.texImage2D(GL.TEXTURE_2D,0,g,this.width,this.height,0,g,GL.UNSIGNED_BYTE,null),
GL.bindRenderbuffer(GL.RENDERBUFFER,this.renderBuffer),GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffer),GL.framebufferTexture2D(GL.FRAMEBUFFER,GL.COLOR_ATTACHMENT0,GL.TEXTURE_2D,this.texture,0),f&&!a?(GL.renderbufferStorage(GL.RENDERBUFFER,GL.DEPTH_COMPONENT16,this.width,this.height),GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.DEPTH_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer)):f&&a?(GL.renderbufferStorage(GL.RENDERBUFFER,GL.DEPTH_STENCIL,width,height),GL.framebufferRenderbuffer(GL.FRAMEBUFFER,
GL.DEPTH_STENCIL_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer)):GL.renderbufferStorage(GL.RENDERBUFFER,GL.RGBA4,this.width,this.height),GL.bindTexture(GL.TEXTURE_2D,null),GL.bindRenderbuffer(GL.RENDERBUFFER,null),GL.bindFramebuffer(GL.FRAMEBUFFER,null)}catch(h){console.error("GLOW.FBO.construct: "+h)}}b.prototype.init=function(a){this.textureUnit=a};b.prototype.bind=function(){GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffer);GL.viewport(this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height);
return this};b.prototype.unbind=function(){GL.bindFramebuffer(GL.FRAMEBUFFER,null);GL.viewport(0,0,GLOW.currentContext.width,GLOW.currentContext.height);return this};b.prototype.setupViewport=function(a){this.viewport.x=a.x!==void 0?a.x:0;this.viewport.y=a.y!==void 0?a.y:0;this.viewport.width=a.width!==void 0?a.width:window.innerWidth;this.viewport.height=a.height!==void 0?a.height:window.innerHeight;return this};b.prototype.resize=function(){return this};b.prototype.generateMipMaps=function(){GL.bindTexture(GL.TEXTURE_2D,
this.texture);GL.generateMipmap(GL.TEXTURE_2D);GL.bindTexture(GL.TEXTURE_2D,null);return this};return b}();
GLOW.Texture=function(){function b(a){if(a.url){this.url=a.url;var d=this.url.toLowerCase();d.indexOf(".jpg")!==-1||d.indexOf(".png")!==-1||d.indexOf(".jpeg")!==-1?(this.image=new Image,this.image.scope=this):(this.video=document.createElement("video"),this.video.scope=this)}else if(a.image)this.image=a.image;else if(a.canvas)this.canvas=a.canvas;else if(a.video)this.video=a.video;else if(a.buffer)this.buffer=a.buffer,this.width=a.width,this.height=a.height;this.id=GLOW.uniqueId();this.internalFormat=
a.internalFormat!==void 0?a.internalFormat:GL.RGBA;this.format=a.format!==void 0?a.format:GL.RGBA;this.type=a.type!==void 0?a.type:GL.UNSIGNED_BYTE;this.wrapS=a.wrapS!==void 0?a.wrapS:a.wrap!==void 0?a.wrap:GL.REPEAT;this.wrapT=a.wrapT!==void 0?a.wrapT:a.wrap!==void 0?a.wrap:GL.REPEAT;this.magFilter=a.magFilter!==void 0?a.magFilter:GL.LINEAR;this.minFilter=a.minFilter!==void 0?a.minFilter:GL.LINEAR_MIPMAP_LINEAR;this.textureUnit=-1;this.texture=void 0}b.prototype.init=function(a){this.textureUnit=
a;this.url?this.image?(this.image.onload=this.onLoadImage,this.image.src=this.url):(this.video.addEventListener("loadeddata",this.onLoadVideo,!1),this.video.src=this.url):this.createTexture()};b.prototype.createTexture=function(){this.texture=GL.createTexture();GL.bindTexture(GL.TEXTURE_2D,this.texture);this.image?GL.texImage2D(GL.TEXTURE_2D,0,this.internalFormat,this.format,this.type,this.image):this.video?GL.texImage2D(GL.TEXTURE_2D,0,this.internalFormat,this.format,this.type,this.video):this.canvas?
GL.texImage2D(GL.TEXTURE_2D,0,this.internalFormat,this.format,this.type,this.canvas):this.buffer&&GL.texImage2D(GL.TEXTURE_2D,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.buffer);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_S,this.wrapS);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_T,this.wrapT);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MIN_FILTER,this.minFilter);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MAG_FILTER,this.magFilter);this.minFilter!==GL.NEAREST&&this.minFilter!==
GL.LINEAR&&GL.generateMipmap(GL.TEXTURE_2D)};b.prototype.updateTexture=function(a){var d=0,b=0,e=0;a&&(d=a.level!==void 0?a.level:d,b=a.xOffset!==void 0?a.level:b,e=a.yOffset!==void 0?a.level:e);GLOW.currentContext.cache.textureCached(this)||GL.bindTexture(GL.TEXTURE_2D,this.texture);this.video?GL.texSubImage2D(GL.TEXTURE_2D,d,b,e,this.format,this.type,this.video):this.canvas?GL.texSubImage2D(GL.TEXTURE_2D,d,b,e,this.format,this.type,this.canvas):this.buffer?GL.texSubImage2D(GL.TEXTURE_2D,d,b,e,this.width,
this.height,this.format,this.type,this.buffer):this.image&&GL.texSubImage2D(GL.TEXTURE_2D,d,b,e,this.format,this.type,this.image);this.minFilter!==GL.NEAREST&&this.minFilter!==GL.LINEAR&&GL.generateMipmap(GL.TEXTURE_2D)};b.prototype.onLoadImage=function(){this.scope.createTexture()};b.prototype.onLoadVideo=function(){this.removeEventListener("loadeddata",this.onLoadVideo,!1);this.scope.createTexture()};return b}();
GLOW.Shader=function(){function b(a){this.id=GLOW.uniqueId();this.compiledData=a.use?a.use.clone(a.except):GLOW.Compiler.compile(a);this.attachData()}b.prototype.attachData=function(){var a,b,c;this.uniforms=this.compiledData.uniforms;this.elements=this.compiledData.elements;this.program=this.compiledData.program;for(a in this.compiledData.uniforms)this[a]===void 0?this[a]=this.compiledData.uniforms[a].data:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on uniform "+a+", not attaching for easy access. Please use Shader.uniforms."+
a+".data to access data.");for(b in this.compiledData.attributes){if(this.attributes===void 0)this.attributes=this.compiledData.attributes;this[b]===void 0?this[b]=this.compiledData.attributes[b]:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on attribute "+b+", not attaching for easy access. Please use Shader.attributes."+b+".data to access data.")}for(c in this.compiledData.interleavedAttributes){if(this.interleavedAttributes===void 0)this.interleavedAttributes=this.compiledData.interleavedAttributes;
this[c]===void 0?this[c]=this.compiledData.interleavedAttributes[c]:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on interleavedAttribute "+b+", not attaching for easy access. Please use Shader.interleavedAttributes."+b+".data to access data.")}};b.prototype.draw=function(){var a=this.compiledData,b=GLOW.currentContext.cache;if(!b.programCached(a.program)){GL.useProgram(a.program);var c=b.setProgramHighestAttributeNumber(a.program);if(c){var e=a.program.highestAttributeNumber,
j=e-c+1;if(c>0)for(;j<=e;j++)GL.enableVertexAttribArray(j);else for(;j>=e;j--)GL.disableVertexAttribArray(j)}}for(var g in a.uniforms)b.uniformCached(a.uniforms[g])||a.uniforms[g].load();for(var f in a.attributes)a.attributes[f].interleaved===!1&&(b.attributeCached(a.attributes[f])||a.attributes[f].bind());for(f in a.interleavedAttributes)a.interleavedAttributes[f].bind();a.preDrawCallback&&a.preDrawCallback(this);a.elements.draw();a.postDrawCallback&&a.postDrawCallback(this)};b.prototype.clone=function(a){return new GLOW.Shader({use:this.compiledData,
except:a})};b.prototype.dispose=function(){};return b}();
GLOW.Elements=function(){function b(a,b,c){this.id=GLOW.uniqueId();this.elements=GL.createBuffer();this.length=a.length;this.type=b!==void 0?b:GL.TRIANGLES;GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,this.elements);GL.bufferData(GL.ELEMENT_ARRAY_BUFFER,a,c?c:GL.STATIC_DRAW)}b.prototype.draw=function(){GLOW.currentContext.cache.elementsCached(this)||GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,this.elements);GL.drawElements(this.type,this.length,GL.UNSIGNED_SHORT,0)};b.prototype.dispose=function(){};return b}();
GLOW.Uniform=function(){function b(){c[GL.INT]=function(){GL.uniform1iv(this.location,this.getNativeValue())};c[GL.FLOAT]=function(){GL.uniform1fv(this.location,this.getNativeValue())};c[GL.INT_VEC2]=function(){GL.uniform2iv(this.location,this.getNativeValue())};c[GL.INT_VEC3]=function(){GL.uniform3iv(this.location,this.getNativeValue())};c[GL.INT_VEC4]=function(){GL.uniform4iv(this.location,this.getNativeValue())};c[GL.FLOAT_VEC2]=function(){GL.uniform2fv(this.location,this.getNativeValue())};c[GL.FLOAT_VEC3]=
function(){GL.uniform3fv(this.location,this.getNativeValue())};c[GL.FLOAT_VEC4]=function(){GL.uniform4fv(this.location,this.getNativeValue())};c[GL.FLOAT_MAT2]=function(){GL.uniformMatrix2fv(this.location,!1,this.getNativeValue())};c[GL.FLOAT_MAT3]=function(){GL.uniformMatrix3fv(this.location,!1,this.getNativeValue())};c[GL.FLOAT_MAT4]=function(){GL.uniformMatrix4fv(this.location,!1,this.getNativeValue())};c[GL.SAMPLER_2D]=function(){this.data.texture!==void 0&&this.data.textureUnit!==-1&&!GLOW.currentContext.cache.textureCached(this.data)&&
(GL.uniform1i(this.location,this.data.textureUnit),GL.activeTexture(GL.TEXTURE0+this.data.textureUnit),GL.bindTexture(GL.TEXTURE_2D,this.data.texture),this.data.video&&this.data.updateTexture())};c[GL.SAMPLER_CUBE]=function(){}}function a(a,j){d||(d=!0,b());this.id=GLOW.uniqueId();this.data=j;this.name=a.name;this.length=a.length;this.type=a.type;this.location=a.location;this.locationNumber=a.locationNumber;this.load=a.loadFunction||c[this.type]}var d=!1,c=[];a.prototype.getNativeValue=function(){return this.data.value};
return a}();
GLOW.Attribute=function(){function b(b,e,j,g){a||(a=!0,d[GL.INT]=1,d[GL.INT_VEC2]=2,d[GL.INT_VEC3]=3,d[GL.INT_VEC4]=4,d[GL.FLOAT]=1,d[GL.FLOAT_VEC2]=2,d[GL.FLOAT_VEC3]=3,d[GL.FLOAT_VEC4]=4,d[GL.FLOAT_MAT2]=4,d[GL.FLOAT_MAT3]=9,d[GL.FLOAT_MAT4]=16);this.id=GLOW.uniqueId();this.data=e;this.location=b.location;this.locationNumber=b.locationNumber;this.offset=this.stride=0;this.usage=j!==void 0?j:GL.STATIC_DRAW;this.interleaved=g!==void 0?g:!1;this.size=d[b.type];this.name=b.name;this.type=b.type;this.interleaved===
!1&&(this.data instanceof Float32Array?this.bufferData(this.data,this.usage):console.error("GLOW.Attribute.constructor: Data for attribute "+this.name+" not in Float32Array format. Please fix. Quitting."))}var a=!1,d=[];b.prototype.setupInterleave=function(a,b){this.interleaved=!0;this.offset=a;this.stride=b};b.prototype.bufferData=function(a,b){if(a!==void 0&&this.data!==a)this.data=a;if(b!==void 0&&this.usage!==b)this.usage=b;if(this.buffer===void 0)this.buffer=GL.createBuffer();GL.bindBuffer(GL.ARRAY_BUFFER,
this.buffer);GL.bufferData(GL.ARRAY_BUFFER,this.data,this.usage)};b.prototype.bind=function(){this.interleaved===!1&&GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.vertexAttribPointer(this.location,this.size,GL.FLOAT,!1,this.stride,this.offset)};b.prototype.clone=function(){this.interleaved?console.error("GLOW.Attribute.clone: Cannot clone interleaved attribute. Please check your interleave setup."):new GLOW.Attribute(this,this.data,this.usage,this.interleaved)};b.prototype.dispose=function(){};return b}();
GLOW.InterleavedAttributes=function(){function b(a){this.id=GLOW.uniqueId();this.attributes=a;var b,c=a[0].data.length/a[0].size,e,j=a.length,g,f,h,i=[],k,l=[];for(e=0;e<j;e++)i[e]=0;for(b=0;b<c;b++)for(e=0;e<j;e++){k=a[e].data;h=i[e];g=0;for(f=a[e].size;g<f;g++)l.push(k[h++]);i[e]=h}this.data=new Float32Array(l);this.usage=a[0].usage;for(e=0;e<j;e++)if(this.usage!==a[e].usage){console.warn("GLOW.InterleavedAttributes.construct: Attribute "+a[e].name+" has different usage, defaulting to STATIC_DRAW.");
this.usage=GL.STATIC_DRAW;break}this.bufferData(this.data,this.usage);for(e=b=0;e<j;e++)b+=a[e].size*4;for(e=c=0;e<j;e++)a[e].setupInterleave(c,b),c+=a[e].size*4}b.prototype.bufferData=function(a,b){if(a!==void 0&&this.data!==a)this.data=a;if(this.buffer===void 0)this.buffer=GL.createBuffer();GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.bufferData(GL.ARRAY_BUFFER,this.data,b?b:GL.STATIC_DRAW)};b.prototype.bind=function(){GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);var a,b=this.attributes.length;for(a=
0;a<b;a++)this.attributes[a].bind()};return b}();
