// GLOW.js r1 - http://github.com/empaempa/GLOW
var GLOW=function(){var b={},a={},c=-1;b.currentContext={};b.registerContext=function(c){a[c.id]=c;b.enableContext(c)};b.getContextById=function(c){if(a[c])return a[c];console.error("Couldn't find context id "+c+", returning current with id "+b.currentContext.id);return b.currentContext};b.enableContext=function(a){b.currentContext=typeof a==="string"?getContextById(a):a;GL=b.GL=b.currentContext.GL};b.uniqueId=function(){return++c};return b}(),GL={};
GLOW.Context=function(){function b(a){a===void 0&&(a={});this.id=a.id!==void 0?a.id:GLOW.uniqueId();this.alpha=a.alpha!==void 0?a.alpha:!0;this.depth=a.depth!==void 0?a.depth:!0;this.antialias=a.antialias!==void 0?a.antialias:!0;this.stencil=a.stencil!==void 0?a.stencil:!1;this.premultipliedAlpha=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0;this.preserveDrawingBuffer=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1;this.width=a.width!==void 0?a.width:window.innerWidth;this.height=
<<<<<<< HEAD
a.height!==void 0?a.height:window.innerHeight;this.cache=new GLOW.Cache;if(a.context)this.GL=a.context,GLOW.registerContext(this);else{try{this.domElement=document.createElement("canvas"),this.GL=this.domElement.getContext("experimental-webgl",{alpha:this.alpha,depth:this.depth,antialias:this.antialias,stencil:this.stencil,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer}),this.domElement.width=this.width,this.domElement.height=this.height}catch(b){console.error("GLOW.Context.construct: "+
b)}GLOW.registerContext(this);this.enableCulling(!0,{frontFace:GL.CCW,cullFace:GL.BACK});this.enableDepthTest(!0,{func:GL.LEQUAL,write:!0,zNear:0,zFar:1});this.enableBlend(!1);this.setupClear({clearBits:GL.COLOR_BUFFER_BIT|GL.DEPTH_BUFFER_BIT});this.setupViewport({x:0,y:0,width:this.width,height:this.height});this.clear()}}b.prototype.setupClear=function(a){var b=a.depth!==void 0?Math.min(1,Math.max(0,a.depth)):1;GL.clearColor(a.red!==void 0?Math.min(1,Math.max(0,a.red)):0,a.green!==void 0?Math.min(1,
Math.max(0,a.green)):0,a.blue!==void 0?Math.min(1,Math.max(0,a.blue)):0,a.alpha!==void 0?Math.min(1,Math.max(0,a.alpha)):1);GL.clearDepth(b);this.clearBits=a.clearBits!==void 0?a.clearBits:this.clearBits;return this};b.prototype.clear=function(a){if(a===void 0)a=this.clearBits;GL.clear(a);return this};b.prototype.enableBlend=function(a,b){a?(GL.enable(GL.BLEND),b&&this.setupBlend(b)):GL.disable(GL.BLEND);return this};b.prototype.setupBlend=function(a){a.equationRGB?(a.equationAlpha&&GL.blendEquationSeparate(a.equationRGB,
a.equationAlpha),a.srcRGB&&GL.blendFuncSeparate(a.srcRGB,a.dstRGB,a.srcAlpha,a.dstAlpha)):(a.equation&&GL.blendEquation(a.equation),a.src&&GL.blendFunc(a.src,a.dst));return this};b.prototype.enableDepthTest=function(a,b){a?(GL.enable(GL.DEPTH_TEST),b&&this.setupDepthTest(b)):GL.disable(GL.DEPTH_TEST);return this};b.prototype.setupDepthTest=function(a){a.func!==void 0&&GL.depthFunc(a.func);a.write!==void 0&&GL.depthMask(a.write);a.zNear!==void 0&&a.zFar!==void 0&&a.zNear<=a.zFar&&GL.depthRange(Math.max(0,
Math.min(1,a.zNear)),Math.max(0,Math.min(1,a.zFar)));return this};b.prototype.enablePolygonOffset=function(a,b){a?(GL.enable(GL.POLYGON_OFFSET_FILL),b&&this.setupPolygonOffset(b)):GL.disable(GL.POLYGON_OFFSET_FILL);return this};b.prototype.setupPolygonOffset=function(a){a.factor&&a.units&&GL.polygonOffset(a.factor,a.units)};b.prototype.enableStencilTest=function(a,b){a?(GL.enable(GL.STENCIL_TEST),b&&this.setupStencilTest(b)):GL.disable(GL.STENCIL_TEST);return this};b.prototype.setupStencilTest=function(a){a.func&&
a.funcFace?GL.stencilFuncSeparate(a.funcFace,a.func,a.funcRef,a.funcMask):a.func&&GL.stencilFunc(a.func,a.funcRef,a.funcMask);a.mask&&a.maskFace?GL.stencilMaskSeparate(a.maskFace,a.mask):a.mask&&GL.stencilMask(a.mask);a.opFail&&a.opFace?GL.stencilOpSeparate(a.opFace,a.opFail,a.opZfail,a.opZpass):a.opFail&&GL.stencilOp(a.opFail,a.opZfail,a.opZpass);return this};b.prototype.enableCulling=function(a,b){a?(GL.enable(GL.CULL_FACE),b&&this.setupCulling(b)):GL.disable(GL.CULL_FACE);return this};b.prototype.setupCulling=
function(a){try{a.frontFace&&GL.frontFace(a.frontFace),a.cullFace&&GL.cullFace(a.cullFace)}catch(b){console.error("GLOW.Context.setupCulling: "+b)}return this};b.prototype.enableScissor=function(a,b){a?(GL.enable(GL.SCISSOR_TEST),b&&this.setupScissor(b)):GL.disable(GL.SCISSOR_TEST);return this};b.prototype.setupScissor=function(a){try{GL.scissor(a.x,a.y,a.width,a.height)}catch(b){console.error("GLOW.Context.setupScissorTest: "+b)}return this};b.prototype.setupViewport=function(a){var a=a!==void 0?
a:{},b=a.x!==void 0?a.x:0,d=a.y!==void 0?a.y:0,e=this.width=a.width!==void 0?a.width:window.innerWidth,a=this.height=a.height!==void 0?a.height:window.innerHeight;this.GL.viewport(b,d,e,a);return this};return b}();
GLOW.Compiler=function(){var b={},a=[];b.compile=function(c){var d,e=a.length,f;for(d=0;d<e;d++)if(f=a[d],c.vertexShader===f.vertexShader&&c.fragmentShader===f.fragmentShader)break;d===e?(d=b.linkProgram(b.compileVertexShader(c.vertexShader),b.compileFragmentShader(c.fragmentShader)),a.push({vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,program:d})):d=f.program;e=c.elements;f=GL.TRIANGLES;var h=c.usage?c.usage:{},g=h.elements;if(c.triangles)e=c.triangles,g=h.triangles;else if(c.triangleStrip)f=
GL.TRIANGLE_STRIP,e=c.triangleStrip,g=h.triangleStrip;else if(c.triangleFan)f=GL.TRIANGLE_FAN,e=c.triangleFan,g=h.triangleFan;else if(c.points)f=GL.POINTS,e=c.points,g=h.points;else if(c.lines)f=GL.LINES,e=c.lines,g=h.lines;else if(c.lineLoop)f=GL.LINE_LOOP,e=c.lineLoop,g=h.lineLoop;else if(c.lineStrip)f=GL.LINE_STRIP,e=c.lineStrip,g=h.lineStrip;return new GLOW.CompiledData(d,b.createUniforms(b.extractUniforms(d),c.data),b.createAttributes(b.extractAttributes(d),c.data,h,c.interleave),b.createElements(e,
f,g),c)};b.compileVertexShader=function(a){var b;b=GL.createShader(GL.VERTEX_SHADER);b.id=GLOW.uniqueId();GL.shaderSource(b,a);GL.compileShader(b);GL.getShaderParameter(b,GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileVertexShader: "+GL.getShaderInfoLog(b));return b};b.compileFragmentShader=function(a){var b;b=GL.createShader(GL.FRAGMENT_SHADER);b.id=GLOW.uniqueId();GL.shaderSource(b,a);GL.compileShader(b);GL.getShaderParameter(b,GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileFragmentShader: "+
GL.getShaderInfoLog(b));return b};b.linkProgram=function(a,b){var e;e=GL.createProgram();e.id=GLOW.uniqueId();GL.attachShader(e,a);GL.attachShader(e,b);GL.linkProgram(e);GL.getProgramParameter(e,GL.LINK_STATUS)||console.error("GLOW.Compiler.linkProgram: Could not initialise program");return e};b.extractUniforms=function(a){for(var b={},e,f=0;;){e=GL.getActiveUniform(a,f);if(e!==null&&e!==-1&&e!==void 0)e={name:e.name.split("[")[0],size:e.size,type:e.type,location:GL.getUniformLocation(a,e.name.split("[")[0]),
locationNumber:f},b[e.name]=e;else break;f++}return b};b.extractAttributes=function(a){for(var b,e=0,f={};;){b=GL.getActiveAttrib(a,e);if(b!==null&&b!==-1&&b!==void 0)b={name:b.name,size:b.size,type:b.type,location:GL.getAttribLocation(a,b.name),locationNumber:e},f[b.name]=b;else break;e++}a.highestAttributeNumber=e-1;return f};b.createUniforms=function(a,b){var e,f={},h,g,i=0;for(e in a)h=a[e],g=h.name,b[g]===void 0?console.warn("GLOW.Compiler.createUniforms: missing declaration for uniform "+g):
b[g]instanceof GLOW.Uniform?f[g]=b[g]:(f[g]=new GLOW.Uniform(h,b[g]),f[g].type===GL.SAMPLER_2D&&f[g].data.init(i++));return f};b.createAttributes=function(a,b,e){var f,h,g,i={};for(f in a)h=a[f],g=h.name,b[g]===void 0?console.warn("GLOW.Compiler.createAttributes: missing declaration for attribute "+g):i[g]=b[g]instanceof GLOW.Attribute?b[g]:new GLOW.Attribute(h,b[g],e[g]);return i};b.createElements=function(a,b,e){var f;a?a instanceof GLOW.Elements?f=a:(a instanceof Uint16Array||(a=new Uint16Array(a)),
f=new GLOW.Elements(a,b,e)):console.error("GLOW.Compiler.createElements: missing 'elements' in supplied data. Quitting.");return f};return b}();
GLOW.CompiledData=function(){function b(a,b,d,e,f){this.program=a;this.uniforms=b!==void 0?b:{};this.attributes=d!==void 0?d:{};this.elements=e;f=f!==void 0?f:{};this.preDrawCallback=f.preDrawCallback;this.postDrawCallback=f.postDrawCallback;this.blend=f.blend;this.stencil=f.stencil}b.prototype.clone=function(a){var b=new GLOW.CompiledData,a=a!==void 0?a:{},d;for(d in this.uniforms)b.uniforms[d]=a[d]?new GLOW.Uniform(this.uniforms[d],a[d]):this.uniforms[d];for(var e in this.attributes)b.attributes[e]=
a[e]?new GLOW.Attribute(this.attributes[e],a[e]):this.attributes[e];b.elements=a.elements?new GLOW.Elements(a.elements):this.elements;b.program=a.program?a.program:this.program;b.blend=a.blend?a.blend:this.blend;b.stencil=a.stencil?a.stencil:this.stencil;b.preDrawCallback=a.preDrawCallback?a.preDrawCallback:this.preDrawCallback;b.postDrawCallback=a.postDrawCallback?a.postDrawCallback:this.postDrawCallback;return b};return b}();
=======
a.height!==void 0?parmaeters.height:window.innerHeight;this.cache=new GLOW.Cache;if(a.context)this.GL=a.context,GLOW.registerContext(this);else{try{this.domElement=document.createElement("canvas"),this.GL=this.domElement.getContext("experimental-webgl",{alpha:this.alpha,depth:this.depth,antialias:this.antialias,stencil:this.stencil,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer}),this.domElement.width=this.width,this.domElement.height=this.height}catch(c){console.error("GLOW.Context.construct: "+
c)}GLOW.registerContext(this);this.enableCulling(!0,{frontFace:GL.CCW,cullFace:GL.BACK});this.enableDepthTest(!0,{func:GL.LEQUAL,write:!0,zNear:0,zFar:1});this.enableBlend(!1);this.setupClear({clearBits:GL.COLOR_BUFFER_BIT|GL.DEPTH_BUFFER_BIT});this.setupViewport({x:0,y:0,width:this.width,height:this.height});this.clear()}}b.prototype.setupClear=function(a){var c=a.depth!==void 0?Math.min(1,Math.max(0,a.depth)):1;GL.clearColor(a.red!==void 0?Math.min(1,Math.max(0,a.red)):0,a.green!==void 0?Math.min(1,
Math.max(0,a.green)):0,a.blue!==void 0?Math.min(1,Math.max(0,a.blue)):0,a.alpha!==void 0?Math.min(1,Math.max(0,a.alpha)):1);GL.clearDepth(c);this.clearBits=a.clearBits!==void 0?a.clearBits:this.clearBits;return this};b.prototype.clear=function(a){if(a===void 0)a=this.clearBits;GL.clear(a);return this};b.prototype.enableBlend=function(a,c){a?(GL.enable(GL.BLEND),c&&this.setupBlend(c)):GL.disable(GL.BLEND);return this};b.prototype.setupBlend=function(a){a.equationRGB?(a.equationAlpha&&GL.blendEquationSeparate(a.equationRGB,
a.equationAlpha),a.srcRGB&&GL.blendFuncSeparate(a.srcRGB,a.dstRGB,a.srcAlpha,a.dstAlpha)):(a.equation&&GL.blendEquation(a.equation),a.src&&GL.blendFunc(a.src,a.dst));return this};b.prototype.enableDepthTest=function(a,c){a?(GL.enable(GL.DEPTH_TEST),c&&this.setupDepthTest(c)):GL.disable(GL.DEPTH_TEST);return this};b.prototype.setupDepthTest=function(a){a.func!==void 0&&GL.depthFunc(a.func);a.write!==void 0&&GL.depthMask(a.write);a.zNear!==void 0&&a.zFar!==void 0&&a.zNear<=a.zFar&&GL.depthRange(Math.max(0,
Math.min(1,a.zNear)),Math.max(0,Math.min(1,a.zFar)));return this};b.prototype.enablePolygonOffset=function(a,c){a?(GL.enable(GL.POLYGON_OFFSET_FILL),c&&this.setupPolygonOffset(c)):GL.disable(GL.POLYGON_OFFSET_FILL);return this};b.prototype.setupPolygonOffset=function(a){a.factor&&a.units&&GL.polygonOffset(a.factor,a.units)};b.prototype.enableStencilTest=function(a,c){a?(GL.enable(GL.STENCIL_TEST),c&&this.setupStencilTest(c)):GL.disable(GL.STENCIL_TEST);return this};b.prototype.setupStencilTest=function(a){a.func&&
a.funcFace?GL.stencilFuncSeparate(a.funcFace,a.func,a.funcRef,a.funcMask):a.func&&GL.stencilFunc(a.func,a.funcRef,a.funcMask);a.mask&&a.maskFace?GL.stencilMaskSeparate(a.maskFace,a.mask):a.mask&&GL.stencilMask(a.mask);a.opFail&&a.opFace?GL.stencilOpSeparate(a.opFace,a.opFail,a.opZfail,a.opZpass):a.opFail&&GL.stencilOp(a.opFail,a.opZfail,a.opZpass);return this};b.prototype.enableCulling=function(a,c){a?(GL.enable(GL.CULL_FACE),c&&this.setupCulling(c)):GL.disable(GL.CULL_FACE);return this};b.prototype.setupCulling=
function(a){try{a.frontFace&&GL.frontFace(a.frontFace),a.cullFace&&GL.cullFace(a.cullFace)}catch(c){console.error("GLOW.Context.setupCulling: "+c)}return this};b.prototype.enableScissor=function(a,c){a?(GL.enable(GL.SCISSOR_TEST),c&&this.setupScissor(c)):GL.disable(GL.SCISSOR_TEST);return this};b.prototype.setupScissor=function(a){try{GL.scissor(a.x,a.y,a.width,a.height)}catch(c){console.error("GLOW.Context.setupScissorTest: "+c)}return this};b.prototype.setupViewport=function(a){var a=a!==void 0?
a:{},c=a.x!==void 0?a.x:0,b=a.y!==void 0?a.y:0,d=this.width=a.width!==void 0?a.width:window.innerWidth,a=this.height=a.height!==void 0?a.height:window.innerHeight;this.GL.viewport(c,b,d,a);return this};return b}();
GLOW.Compiler=function(){var b={},a=[];b.compile=function(c){var e,d=a.length,f;for(e=0;e<d;e++)if(f=a[e],c.vertexShader===f.vertexShader&&c.fragmentShader===f.fragmentShader)break;e===d?(e=b.linkProgram(b.compileVertexShader(c.vertexShader),b.compileFragmentShader(c.fragmentShader)),a.push({vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,program:e})):e=f.program;d=b.createUniforms(b.extractUniforms(e),c.data);f=b.createAttributes(b.extractAttributes(e),c.data,c.usage,c.interleave);var h=
b.interleaveAttributes(f,c.interleave),g=c.elements,i=GL.TRIANGLES,j=c.usage?c.usage:{},k=j.elements;if(c.triangles)g=c.triangles,k=j.triangles;else if(c.triangleStrip)g=c.triangleStrip,i=GL.TRIANGLE_STRIP,k=j.triangleStrip;else if(c.triangleFan)g=c.triangleFan,i=GL.TRIANGLE_FAN,k=j.triangleFan;else if(c.points)g=c.points,i=GL.POINTS,k=j.points;else if(c.lines)g=c.lines,i=GL.LINES,k=j.lines;else if(c.lineLoop)g=c.lineLoop,i=GL.LINE_LOOP,k=j.lineLoop;else if(c.lineStrip)g=c.lineStrip,i=GL.LINE_STRIP,
k=j.lineStrip;g=b.createElements(g,i,k);return new GLOW.CompiledData(e,d,f,h,g,c)};b.compileVertexShader=function(a){var b;b=GL.createShader(GL.VERTEX_SHADER);b.id=GLOW.uniqueId();GL.shaderSource(b,a);GL.compileShader(b);GL.getShaderParameter(b,GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileVertexShader: "+GL.getShaderInfoLog(b));return b};b.compileFragmentShader=function(a){var b;b=GL.createShader(GL.FRAGMENT_SHADER);b.id=GLOW.uniqueId();GL.shaderSource(b,a);GL.compileShader(b);GL.getShaderParameter(b,
GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileFragmentShader: "+GL.getShaderInfoLog(b));return b};b.linkProgram=function(a,b){var d;d=GL.createProgram();d.id=GLOW.uniqueId();GL.attachShader(d,a);GL.attachShader(d,b);GL.linkProgram(d);GL.getProgramParameter(d,GL.LINK_STATUS)||console.error("GLOW.Compiler.linkProgram: Could not initialise program");return d};b.extractUniforms=function(a){for(var b={},d,f=0;;){d=GL.getActiveUniform(a,f);if(d!==null&&d!==-1&&d!==void 0)d={name:d.name.split("[")[0],
size:d.size,type:d.type,location:GL.getUniformLocation(a,d.name.split("[")[0]),locationNumber:f},b[d.name]=d;else break;f++}return b};b.extractAttributes=function(a){for(var b,d=0,f={};;){b=GL.getActiveAttrib(a,d);if(b!==null&&b!==-1&&b!==void 0)b={name:b.name,size:b.size,type:b.type,location:GL.getAttribLocation(a,b.name),locationNumber:d},f[b.name]=b;else break;d++}a.highestAttributeNumber=d-1;return f};b.createUniforms=function(a,b){var d,f={},h,g,i=0;for(d in a)h=a[d],g=h.name,b[g]===void 0?console.warn("GLOW.Compiler.createUniforms: missing declaration for uniform "+
g):b[g]instanceof GLOW.Uniform?f[g]=b[g]:(f[g]=new GLOW.Uniform(h,b[g]),f[g].type===GL.SAMPLER_2D&&f[g].data.init(i++));return f};b.createAttributes=function(a,b,d,f){var h,g,i,j={},f=f!==void 0?f:{},d=d!==void 0?d:{};for(h in a)g=a[h],i=g.name,b[i]===void 0?console.warn("GLOW.Compiler.createAttributes: missing declaration for attribute "+i):j[i]=b[i]instanceof GLOW.Attribute?b[i]:new GLOW.Attribute(g,b[i],d[i],f[i]!==void 0?f[i]:!0);return j};b.interleaveAttributes=function(a,b){var b=b!==void 0?
b:{},d,f,h,g,i;f=0;var j=[];for(d in a)b[d]!==void 0&&b[d]!==!1&&(f=Math.max(f-1,b[d])+1);for(d in a)b[d]===void 0&&(b[d]=f);for(i in b)b[i]!==!1&&(j[b[i]]===void 0&&(j[b[i]]=[]),j[b[i]].push(a[i]));var k,l;d=0;for(f=j.length;d<f;d++)if(j[d]!==void 0){h=k=0;for(g=j[d].length;h<g;h++)if(k+j[d][h].size*4>255){console.warn("GLOW.Compiler.interleaveAttributes: Stride owerflow, moving attributes to new interleave index. Please check your interleave setup!");l=j.length;for(j[l]=[];h<g;)j[l].push(j[d][h]),
j[d].splice(h,1),g--}else k+=j[d][h].size*4}l={};d=0;for(f=j.length;d<f;d++)if(j[d]!==void 0){k="";h=0;for(g=j[d].length;h<g;h++)k+=h!==g-1?j[d][h].name+"_":j[d][h].name;l[k]=new GLOW.InterleavedAttributes(j[d])}for(i in b)b[i]!==!1&&delete a[i];return l};b.createElements=function(a,b,d){var f;a===void 0?console.error("GLOW.Compiler.createElements: missing 'elements' in supplied data. Quitting."):a instanceof GLOW.Elements?f=a:(a instanceof Uint16Array||(a=new Uint16Array(a)),f=new GLOW.Elements(a,
b,d!==void 0?d:GL.STATIC_DRAW));return f};return b}();
GLOW.CompiledData=function(){function b(a,b,e,d,f,h){this.program=a;this.uniforms=b!==void 0?b:{};this.attributes=e!==void 0?e:{};this.interleavedAttributes=d!==void 0?d:{};this.elements=f;h=h!==void 0?h:{};this.preDrawCallback=h.preDrawCallback;this.postDrawCallback=h.postDrawCallback;this.blend=h.blend;this.stencil=h.stencil}b.prototype.clone=function(a){var b=new GLOW.CompiledData,a=a!==void 0?a:{},e;for(e in this.uniforms)b.uniforms[e]=a[e]?new GLOW.Uniform(this.uniforms[e],a[e]):this.uniforms[e];
for(var d in this.attributes)b.attributes[d]=a[d]?new GLOW.Attribute(this.attributes[d],a[d]):this.attributes[d];for(var f in this.interleavedAttributes)b.interleavedAttributes[f]=a[f]?new GLOW.InterleavedAttributes(a[f]):this.interleavedAttributes[f];b.elements=a.elements?new GLOW.Elements(a.elements):this.elements;b.program=a.program?a.program:this.program;b.blend=a.blend?a.blend:this.blend;b.stencil=a.stencil?a.stencil:this.stencil;b.preDrawCallback=a.preDrawCallback?a.preDrawCallback:this.preDrawCallback;
b.postDrawCallback=a.postDrawCallback?a.postDrawCallback:this.postDrawCallback;return b};return b}();
>>>>>>> Interleaved Attributes
GLOW.Cache=function(){function b(){this.highestAttributeNumber=-1;this.uniformByLocation=[];this.attributeByLocation=[];this.textureByLocation=[];this.programId=this.elementId=-1;this.active=!0}b.prototype.programCached=function(a){if(this.active){if(a.id===this.programId)return!0;this.programId=a.id}return!1};b.prototype.setProgramHighestAttributeNumber=function(a){var b=this.highestAttributeNumber;this.highestAttributeNumber=a.highestAttributeNumber;return a.highestAttributeNumber-b};b.prototype.uniformCached=
function(a){if(this.active){if(this.uniformByLocation[a.locationNumber]===a.id)return!0;this.uniformByLocation[a.locationNumber]=a.id}return!1};b.prototype.attributeCached=function(a){if(this.active){if(this.attributeByLocation[a.locationNumber]===a.id)return!0;this.attributeByLocation[a.locationNumber]=a.id}return!1};b.prototype.textureCached=function(a){if(this.active){if(this.textureByLocation[a.textureUnit]===a.id)return!0;this.textureByLocation[a.textureUnit]=a.id}return!1};b.prototype.elementsCached=
function(a){if(this.active){if(a.id===this.elementId)return!0;this.elementId=a.id}return!1};b.prototype.clear=function(){this.highestAttributeNumber=-1;this.uniformByLocation.length=0;this.attributeByLocation.length=0;this.textureByLocation.length=0;this.programId=this.elementId=-1};return b}();
GLOW.FBO=function(){function b(a){a=a!==void 0?a:{};this.id=GLOW.uniqueId();this.width=a.width!==void 0?a.width:window.innerWidth;this.height=a.height!==void 0?a.height:window.innerHeight;var b=a.wrapS!==void 0?a.wrapS:GL.CLAMP_TO_EDGE,e=a.wrapT!==void 0?a.wrapT:GL.CLAMP_TO_EDGE,d=a.magFilter!==void 0?a.magFilter:GL.LINEAR,f=a.minFilter!==void 0?a.minFilter:GL.LINEAR,h=a.format!==void 0?a.format:GL.RGBA,g=a.depth!==void 0?a.depth:!0,a=a.stencil!==void 0?paramaters.stencil:!1;this.textureUnit=-1;this.frameBuffer=
GL.createFramebuffer();this.renderBuffer=GL.createRenderbuffer();this.texture=GL.createTexture();this.viewport={x:0,y:0,width:this.width,height:this.height};try{GL.bindTexture(GL.TEXTURE_2D,this.texture),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_S,b),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_T,e),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MAG_FILTER,d),GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MIN_FILTER,f),GL.texImage2D(GL.TEXTURE_2D,0,h,this.width,this.height,0,h,GL.UNSIGNED_BYTE,null),
GL.bindRenderbuffer(GL.RENDERBUFFER,this.renderBuffer),GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffer),GL.framebufferTexture2D(GL.FRAMEBUFFER,GL.COLOR_ATTACHMENT0,GL.TEXTURE_2D,this.texture,0),g&&!a?(GL.renderbufferStorage(GL.RENDERBUFFER,GL.DEPTH_COMPONENT16,this.width,this.height),GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.DEPTH_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer)):g&&a?(GL.renderbufferStorage(GL.RENDERBUFFER,GL.DEPTH_STENCIL,width,height),GL.framebufferRenderbuffer(GL.FRAMEBUFFER,
GL.DEPTH_STENCIL_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer)):GL.renderbufferStorage(GL.RENDERBUFFER,GL.RGBA4,this.width,this.height),GL.bindTexture(GL.TEXTURE_2D,null),GL.bindRenderbuffer(GL.RENDERBUFFER,null),GL.bindFramebuffer(GL.FRAMEBUFFER,null)}catch(i){console.error("GLOW.FBO.construct: "+i)}}b.prototype.init=function(a){this.textureUnit=a};b.prototype.bind=function(){GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffer);GL.viewport(this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height);
return this};b.prototype.unbind=function(){GL.bindFramebuffer(GL.FRAMEBUFFER,null);GL.viewport(0,0,GLOW.currentContext.width,GLOW.currentContext.height);return this};b.prototype.setupViewport=function(a){this.viewport.x=a.x!==void 0?a.x:0;this.viewport.y=a.y!==void 0?a.y:0;this.viewport.width=a.width!==void 0?a.width:window.innerWidth;this.viewport.height=a.height!==void 0?a.height:window.innerHeight;return this};b.prototype.resize=function(){return this};b.prototype.generateMipMaps=function(){GL.bindTexture(GL.TEXTURE_2D,
this.texture);GL.generateMipmap(GL.TEXTURE_2D);GL.bindTexture(GL.TEXTURE_2D,null);return this};return b}();GLOW.Texture=function(b){this.url=b;this.id=GLOW.uniqueId();this.textureUnit=-1;this.texture=void 0;this.image=new Image;this.image.scope=this};GLOW.Texture.prototype.init=function(b){this.textureUnit=b;this.image.onload=this.onLoad;this.image.src=this.url};
GLOW.Texture.prototype.onLoad=function(){var b=this.scope;b.texture=GL.createTexture();GL.bindTexture(GL.TEXTURE_2D,b.texture);GL.texImage2D(GL.TEXTURE_2D,0,GL.RGBA,GL.RGBA,GL.UNSIGNED_BYTE,this);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_S,GL.REPEAT);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_WRAP_T,GL.REPEAT);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MAG_FILTER,GL.LINEAR);GL.texParameteri(GL.TEXTURE_2D,GL.TEXTURE_MIN_FILTER,GL.LINEAR_MIPMAP_LINEAR);GL.generateMipmap(GL.TEXTURE_2D)};
<<<<<<< HEAD
GLOW.Shader=function(){function b(a){this.id=GLOW.uniqueId();this.compiledData=a.use?a.use.clone(a.except):GLOW.Compiler.compile(a);this.attachData()}b.prototype.attachData=function(){var a,b;this.uniforms=this.compiledData.uniforms;this.attributes=this.compiledData.attributes;this.elements=this.compiledData.elements;this.program=this.compiledData.program;for(a in this.compiledData.uniforms)this[a]===void 0?this[a]=this.compiledData.uniforms[a].data:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on uniform "+
a+", not attaching for easy access. Please use Shader.uniforms."+a+".data to access data.");for(b in this.compiledData.attributes)this[b]===void 0?this[b]=this.compiledData.attributes[b].data:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on attribute "+b+", not attaching for easy access. Please use Shader.attributes."+b+".data to access data.")};b.prototype.draw=function(){var a=this.compiledData,b=GLOW.currentContext.cache;if(!b.programCached(a.program)){var d=b.setProgramHighestAttributeNumber(a.program);
if(d){var e=a.program.highestAttributeNumber,f=e-d+1;if(d>0)for(;f<=e;f++)GL.enableVertexAttribArray(f);else for(;f>=e;f--)GL.disableVertexAttribArray(f)}GL.useProgram(a.program)}for(var h in a.uniforms)b.uniformCached(a.uniforms[h])||a.uniforms[h].load();for(var g in a.attributes)b.attributeCached(a.attributes[g])||a.attributes[g].bind();a.preDrawCallback&&a.preDrawCallback(this);a.elements.draw();a.postDrawCallback&&a.postDrawCallback(this)};b.prototype.clone=function(a){return new GLOW.Shader({use:this.compiledData,
except:a})};b.prototype.dispose=function(){};return b}();
GLOW.Elements=function(){function b(a,b,d){this.id=GLOW.uniqueId();this.elements=GL.createBuffer();this.length=a.length;this.type=b!==void 0?b:GL.TRIANGLES;GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,this.elements);GL.bufferData(GL.ELEMENT_ARRAY_BUFFER,a,d?d:GL.STATIC_DRAW)}b.prototype.draw=function(){GLOW.currentContext.cache.elementsCached(this)||GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,this.elements);GL.drawElements(this.type,this.length,GL.UNSIGNED_SHORT,0)};b.prototype.dispose=function(){};return b}();
GLOW.Uniform=function(){function b(){d[GL.INT]=function(){GL.uniform1iv(this.location,this.getNativeValue())};d[GL.FLOAT]=function(){GL.uniform1fv(this.location,this.getNativeValue())};d[GL.INT_VEC2]=function(){GL.uniform2iv(this.location,this.getNativeValue())};d[GL.INT_VEC3]=function(){GL.uniform3iv(this.location,this.getNativeValue())};d[GL.INT_VEC4]=function(){GL.uniform4iv(this.location,this.getNativeValue())};d[GL.FLOAT_VEC2]=function(){GL.uniform2fv(this.location,this.getNativeValue())};d[GL.FLOAT_VEC3]=
function(){GL.uniform3fv(this.location,this.getNativeValue())};d[GL.FLOAT_VEC4]=function(){GL.uniform4fv(this.location,this.getNativeValue())};d[GL.FLOAT_MAT2]=function(){GL.uniformMatrix2fv(this.location,!1,this.getNativeValue())};d[GL.FLOAT_MAT3]=function(){GL.uniformMatrix3fv(this.location,!1,this.getNativeValue())};d[GL.FLOAT_MAT4]=function(){GL.uniformMatrix4fv(this.location,!1,this.getNativeValue())};d[GL.SAMPLER_2D]=function(){this.data.texture!==void 0&&this.data.textureUnit!==-1&&!GLOW.currentContext.cache.textureCached(this.data)&&
(GL.uniform1i(this.location,this.data.textureUnit),GL.activeTexture(GL.TEXTURE0+this.data.textureUnit),GL.bindTexture(GL.TEXTURE_2D,this.data.texture))};d[GL.SAMPLER_CUBE]=function(){}}function a(a,f){c||(c=!0,b());this.id=GLOW.uniqueId();this.data=f;this.name=a.name;this.length=a.length;this.type=a.type;this.location=a.location;this.locationNumber=a.locationNumber;this.load=a.loadFunction||d[this.type]}var c=!1,d=[];a.prototype.getNativeValue=function(){return this.data.value};return a}();
GLOW.Attribute=function(){function b(b,e,f,h){a||(a=!0,c[GL.INT]=1,c[GL.INT_VEC2]=2,c[GL.INT_VEC3]=3,c[GL.INT_VEC4]=4,c[GL.FLOAT]=1,c[GL.FLOAT_VEC2]=2,c[GL.FLOAT_VEC3]=3,c[GL.FLOAT_VEC4]=4,c[GL.FLOAT_MAT2]=4,c[GL.FLOAT_MAT3]=9,c[GL.FLOAT_MAT4]=16);this.id=GLOW.uniqueId();this.data=e;this.location=b.location;this.locationNumber=b.locationNumber;this.offset=this.stride=0;this.size=c[b.type];this.buffer=GL.createBuffer();this.name=b.name;this.type=b.type;if(!h)if(this.data instanceof Float32Array)this.setData(this.data,
f);else{for(var b=this.data.length,h=this.size,g=new Float32Array(b*h),i=0,j=0;j<b;j++)for(var l=0;l<h;l++)g[i++]=e[j].value[l];this.setData(g,f)}}var a=!1,c=[];b.prototype.interleave=function(a,b,c){this.stride=b;this.offset=c};b.prototype.setData=function(a,b){this.data=a;GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.bufferData(GL.ARRAY_BUFFER,this.data,b?b:GL.STATIC_DRAW)};b.prototype.bind=function(){GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.vertexAttribPointer(this.location,this.size,GL.FLOAT,
!1,this.stride,this.offset)};b.prototype.dispose=function(){};return b}();
=======
GLOW.Shader=function(){function b(a){this.id=GLOW.uniqueId();this.compiledData=a.use?a.use.clone(a.except):GLOW.Compiler.compile(a);this.attachData()}b.prototype.attachData=function(){var a,b;this.uniforms=this.compiledData.uniforms;this.interleavedAttributes=this.compiledData.interleavedAttributes;this.elements=this.compiledData.elements;this.program=this.compiledData.program;for(a in this.compiledData.uniforms)this[a]===void 0?this[a]=this.compiledData.uniforms[a].data:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on uniform "+
a+", not attaching for easy access. Please use Shader.uniforms."+a+".data to access data.");for(b in this.compiledData.attributes){if(this.attributes===void 0)this.attributes=this.compiledData.attributes;this[b]===void 0?this[b]=this.compiledData.attributes[b].data:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on attribute "+b+", not attaching for easy access. Please use Shader.attributes."+b+".data to access data.")}};b.prototype.draw=function(){var a=this.compiledData,
b=GLOW.currentContext.cache;if(!b.programCached(a.program)){GL.useProgram(a.program);var e=b.setProgramHighestAttributeNumber(a.program);if(e){var d=a.program.highestAttributeNumber,f=d-e+1;if(e>0)for(;f<=d;f++)GL.enableVertexAttribArray(f);else for(;f>=d;f--)GL.disableVertexAttribArray(f)}}for(var h in a.uniforms)b.uniformCached(a.uniforms[h])||a.uniforms[h].load();for(var g in a.attributes)a.attributes[g].interleaved===!1&&(b.attributeCached(a.attributes[g])||a.attributes[g].bind());for(g in a.interleavedAttributes)a.interleavedAttributes[g].bind();
a.preDrawCallback&&a.preDrawCallback(this);a.elements.draw();a.postDrawCallback&&a.postDrawCallback(this)};b.prototype.clone=function(a){return new GLOW.Shader({use:this.compiledData,except:a})};b.prototype.dispose=function(){};return b}();
GLOW.Elements=function(){function b(a,b,e){this.id=GLOW.uniqueId();this.elements=GL.createBuffer();this.length=a.length;this.type=b!==void 0?b:GL.TRIANGLES;GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,this.elements);GL.bufferData(GL.ELEMENT_ARRAY_BUFFER,a,e?e:GL.STATIC_DRAW)}b.prototype.draw=function(){GLOW.currentContext.cache.elementsCached(this)||GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,this.elements);GL.drawElements(this.type,this.length,GL.UNSIGNED_SHORT,0)};b.prototype.dispose=function(){};return b}();
GLOW.Uniform=function(){function b(){e[GL.INT]=function(){GL.uniform1iv(this.location,this.getNativeValue())};e[GL.FLOAT]=function(){GL.uniform1fv(this.location,this.getNativeValue())};e[GL.INT_VEC2]=function(){GL.uniform2iv(this.location,this.getNativeValue())};e[GL.INT_VEC3]=function(){GL.uniform3iv(this.location,this.getNativeValue())};e[GL.INT_VEC4]=function(){GL.uniform4iv(this.location,this.getNativeValue())};e[GL.FLOAT_VEC2]=function(){GL.uniform2fv(this.location,this.getNativeValue())};e[GL.FLOAT_VEC3]=
function(){GL.uniform3fv(this.location,this.getNativeValue())};e[GL.FLOAT_VEC4]=function(){GL.uniform4fv(this.location,this.getNativeValue())};e[GL.FLOAT_MAT2]=function(){GL.uniformMatrix2fv(this.location,!1,this.getNativeValue())};e[GL.FLOAT_MAT3]=function(){GL.uniformMatrix3fv(this.location,!1,this.getNativeValue())};e[GL.FLOAT_MAT4]=function(){GL.uniformMatrix4fv(this.location,!1,this.getNativeValue())};e[GL.SAMPLER_2D]=function(){this.data.texture!==void 0&&this.data.textureUnit!==-1&&!GLOW.currentContext.cache.textureCached(this.data)&&
(GL.uniform1i(this.location,this.data.textureUnit),GL.activeTexture(GL.TEXTURE0+this.data.textureUnit),GL.bindTexture(GL.TEXTURE_2D,this.data.texture))};e[GL.SAMPLER_CUBE]=function(){}}function a(a,f){c||(c=!0,b());this.id=GLOW.uniqueId();this.data=f;this.name=a.name;this.length=a.length;this.type=a.type;this.location=a.location;this.locationNumber=a.locationNumber;this.load=a.loadFunction||e[this.type]}var c=!1,e=[];a.prototype.getNativeValue=function(){return this.data.value};return a}();
GLOW.Attribute=function(){function b(b,d,f,h){a||(a=!0,c[GL.INT]=1,c[GL.INT_VEC2]=2,c[GL.INT_VEC3]=3,c[GL.INT_VEC4]=4,c[GL.FLOAT]=1,c[GL.FLOAT_VEC2]=2,c[GL.FLOAT_VEC3]=3,c[GL.FLOAT_VEC4]=4,c[GL.FLOAT_MAT2]=4,c[GL.FLOAT_MAT3]=9,c[GL.FLOAT_MAT4]=16);this.id=GLOW.uniqueId();this.data=d;this.location=b.location;this.locationNumber=b.locationNumber;this.offset=this.stride=0;this.usage=f!==void 0?f:GL.STATIC_DRAW;this.interleaved=h!==void 0?h:!1;this.size=c[b.type];this.name=b.name;this.type=b.type;this.interleaved===
!1&&(this.data instanceof Float32Array?this.bufferData(this.data,this.usage):console.error("GLOW.Attribute.constructor: Data for attribute "+this.name+" not in Float32Array format. Please fix. Quitting."))}var a=!1,c=[];b.prototype.setupInterleave=function(a,b){this.interleaved=!0;this.offset=a;this.stride=b};b.prototype.bufferData=function(a,b){if(a!==void 0&&this.data!==a)this.data=a;if(b!==void 0&&this.usage!==b)this.usage=b;if(this.buffer===void 0)this.buffer=GL.createBuffer();GL.bindBuffer(GL.ARRAY_BUFFER,
this.buffer);GL.bufferData(GL.ARRAY_BUFFER,this.data,this.usage)};b.prototype.bind=function(){this.interleaved===!1&&GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.vertexAttribPointer(this.location,this.size,GL.FLOAT,!1,this.stride,this.offset)};b.prototype.clone=function(){this.interleaved?console.error("GLOW.Attribute.clone: Cannot clone interleaved attribute. Please check your interleave setup."):new GLOW.Attribute(this,this.data,this.usage,this.interleaved)};b.prototype.dispose=function(){};return b}();
GLOW.InterleavedAttributes=function(){function b(a){this.id=GLOW.uniqueId();this.attributes=a;var b,e=a[0].data.length/a[0].size,d,f=a.length,h,g,i,j=[],k,l=[];for(d=0;d<f;d++)j[d]=0;for(b=0;b<e;b++)for(d=0;d<f;d++){k=a[d].data;i=j[d];h=0;for(g=a[d].size;h<g;h++)l.push(k[i++]);j[d]=i}this.data=new Float32Array(l);this.usage=a[0].usage;for(d=0;d<f;d++)if(this.usage!==a[d].usage){console.warn("GLOW.InterleavedAttributes.construct: Attribute "+a[d].name+" has different usage, defaulting to STATIC_DRAW.");
this.usage=GL.STATIC_DRAW;break}this.bufferData(this.data,this.usage);for(d=b=0;d<f;d++)b+=a[d].size*4;for(d=e=0;d<f;d++)a[d].setupInterleave(e,b),e+=a[d].size*4}b.prototype.bufferData=function(a,b){if(a!==void 0&&this.data!==a)this.data=a;if(this.buffer===void 0)this.buffer=GL.createBuffer();GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.bufferData(GL.ARRAY_BUFFER,this.data,b?b:GL.STATIC_DRAW)};b.prototype.bind=function(){GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);var a,b=this.attributes.length;for(a=
0;a<b;a++)this.attributes[a].bind()};return b}();
>>>>>>> Interleaved Attributes
GLOW.Float=function(){function b(a){this.value=new Float32Array(1);this.value[0]=a!==void 0?a:0}b.prototype.set=function(a){this.value[0]=a;return this};b.prototype.add=function(a){this.value[0]+=a;return this};b.prototype.sub=function(a){this.value[0]-=a;return this};b.prototype.multiply=function(a){this.value[0]*=a;return this};b.prototype.divide=function(a){this.value[0]/=a;return this};b.prototype.modulo=function(a){this.value[0]%=a;return this};return b}();
GLOW.Int=function(){function b(a){this.value=new int32Array(1);this.value[0]=a!==void 0?a:0}b.prototype.set=function(a){this.value[0]=a;return this};b.prototype.add=function(a){this.value[0]+=a;return this};b.prototype.sub=function(a){this.value[0]-=a;return this};b.prototype.multiply=function(a){this.value[0]*=a;return this};b.prototype.divide=function(a){this.value[0]/=a;return this};b.prototype.modulo=function(a){this.value[0]%=a;return this};return b};
GLOW.Vector2=function(){function b(a,b){this.value=new Float32Array(2);this.value[0]=a!==void 0?a:0;this.value[1]=b!==void 0?b:0}b.prototype.set=function(a,b){this.value[0]=a;this.value[1]=b;return this};b.prototype.copy=function(a){this.value[0]=a.value[0];this.value[1]=a.value[1];return this};b.prototype.addSelf=function(a){this.value[0]+=a.value[0];this.value[1]+=a.value[1];return this};b.prototype.add=function(a,b){this.value[0]=a.value[0]+b.value[0];this.value[1]=a.value[1]+b.value[1];return this};
b.prototype.subSelf=function(a){this.value[0]-=a.x;this.value[1]-=a.y;return this};b.prototype.sub=function(a,b){this.value[0]=a.value[0]-b.value[0];this.value[1]=a.value[1]-b.value[1];return this};b.prototype.multiplySelf=function(a){this.value[0]*=a.value[0];this.value[1]*=a.value[1];return this};b.prototype.multiply=function(a,b){this.value[0]=a.value[0]*b.value[0];this.value[1]=a.value[1]*b.value[1];return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[1]*=a;return this};
b.prototype.negate=function(){this.value[0]=-this.value[0];this.value[1]=-this.value[1];return this};b.prototype.normalize=function(){this.multiplyScalar(1/this.length());return this};b.prototype.length=function(){return Math.sqrt(this.lengthSq())};b.prototype.lengthSq=function(){return this.value[0]*this.value[0]+this.value[1]*this.value[1]};b.prototype.clone=function(){return new GLOW.Vector2(this.value[0],this.value[1])};return b}();
GLOW.Vector3=function(){function b(a,b,e){this.value=new Float32Array(3);this.value[0]=a!==void 0?a:0;this.value[1]=b!==void 0?b:0;this.value[2]=e!==void 0?e:0}b.prototype.set=function(a,b,e){this.value[0]=a;this.value[1]=b;this.value[2]=e;return this};b.prototype.copy=function(){this.set(this.value[0],this.value[1],this.value[2]);return this};b.prototype.add=function(a,b){a=a.value;b=b.value;this.value[0]=a[0]+b[0];this.value[1]=a[1]+b[1];this.value[2]=a[2]+b[2];return this};b.prototype.addSelf=
function(a){a=a.value;this.value[0]+=a[0];this.value[1]+=a[1];this.value[2]+=a[2];return this};b.prototype.addScalar=function(a){this.value[0]+=a;this.value[1]+=a;this.value[2]+=a;return this};b.prototype.sub=function(a,b){a=a.value;b=b.value;this.value[0]=a[0]-b[0];this.value[1]=a[1]-b[1];this.value[2]=a[2]-b[2];return this};b.prototype.subSelf=function(a){a=a.value;this.value[0]-=a[0];this.value[1]-=a[1];this.value[2]-=a[2];return this};b.prototype.cross=function(a,b){a=a.value;b=b.value;this.value[0]=
a[1]*b[2]-a[2]*b[1];this.value[1]=a[2]*b[0]-a[0]*b[2];this.value[2]=a[0]*b[1]-a[1]*b[0];return this};b.prototype.crossSelf=function(a){var a=a.value,b=a[0],e=a[1],a=a[2],d=this.value[0],f=this.value[1],h=this.value[2];this.value[0]=e*h-a*f;this.value[1]=a*d-b*h;this.value[2]=b*f-e*d;return this};b.prototype.multiply=function(a,b){a=a.value;b=b.value;this.value[0]=a[0]*b[0];this.value[1]=a[1]*b[1];this.value[2]=a[2]*b[2];return this};b.prototype.multiplySelf=function(a){a=a.value;this.value[0]*=a[0];
this.value[1]*=a[1];this.value[2]*=a[2];return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[1]*=a;this.value[2]*=a;return this};b.prototype.divideSelf=function(a){a=a.value;this.value[0]/=a[0];this.value[1]/=a[1];this.value[2]/=a[2];return this};b.prototype.divideScalar=function(a){this.value[0]/=a;this.value[1]/=a;this.value[2]/=a;return this};b.prototype.negate=function(){this.value[0]=-this.value[0];this.value[1]=-this.value[1];this.value[2]=-this.value[2];return this};
b.prototype.dot=function(a){a=a.value;return this.value[0]*a[0]+this.value[1]*a[1]+this.value[2]*a[2]};b.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))};b.prototype.distanceToSquared=function(a){var a=a.value,b=this.value[0]-a[0],e=this.value[1]-a[1],a=this.value[2]-a[2];return b*b+e*e+a*a};b.prototype.length=function(){return Math.sqrt(this.lengthSq())};b.prototype.lengthSq=function(){return this.value[0]*this.value[0]+this.value[1]*this.value[1]+this.value[2]*this.value[2]};
b.prototype.lengthManhattan=function(){return this.value[0]+this.value[1]+this.value[2]};b.prototype.normalize=function(){var a=Math.sqrt(this.value[0]*this.value[0]+this.value[1]*this.value[1]+this.value[2]*this.value[2]);a>0?this.multiplyScalar(1/a):this.set(0,0,0);return this};b.prototype.setPositionFromMatrix=function(a){a=a.value;this.value[0]=a[12];this.value[1]=a[13];this.value[2]=a[14]};b.prototype.setLength=function(a){return this.normalize().multiplyScalar(a)};b.prototype.isZero=function(){return Math.abs(this.value[0])<
1.0E-4&&Math.abs(this.value[1])<1.0E-4&&Math.abs(this.value[2])<1.0E-4};b.prototype.clone=function(){return GLOW.Vector3(this.value[0],this.value[1],this.value[2])};return b}();
GLOW.Vector4=function(){function b(a,b,e,d){this.value=new Float32Array(4);this.value[0]=a!==void 0?a:0;this.value[1]=b!==void 0?b:0;this.value[2]=e!==void 0?e:0;this.value[3]=d!==void 0?d:0}b.prototype.set=function(a,b,e,d){this.value[0]=a;this.value[1]=b;this.value[2]=e;this.value[3]=d;return this};b.prototype.copy=function(a){this.value[0]=a.value[0];this.value[1]=a.value[1];this.value[2]=a.value[2];this.value[3]=a.value[3];return this};b.prototype.add=function(a,b){this.value[0]=a.value[0]+b.value[0];
this.value[1]=a.value[1]+b.value[1];this.value[2]=a.value[2]+b.value[2];this.value[3]=a.value[3]+b.value[3];return this};b.prototype.addSelf=function(a){this.value[0]+=a.value[0];this.value[1]+=a.value[1];this.value[2]+=a.value[2];this.value[3]+=a.value[3];return this};b.prototype.sub=function(a,b){this.value[0]=a.value[0]-b.value[0];this.value[1]=a.value[1]-b.value[1];this.value[2]=a.value[2]-b.value[2];this.value[3]=a.value[3]-b.value[3];return this};b.prototype.subSelf=function(a){this.value[0]-=
a.value[0];this.value[1]-=a.value[1];this.value[2]-=a.value[2];this.value[3]-=a.value[3];return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[1]*=a;this.value[2]*=a;this.value[3]*=a;return this};b.prototype.divideScalar=function(a){this.value[0]/=a;this.value[1]/=a;this.value[2]/=a;this.value[3]/=a;return this};b.prototype.lerpSelf=function(a,b){this.value[0]+=(a.x-this.value[0])*b;this.value[1]+=(a.y-this.value[1])*b;this.value[2]+=(a.z-this.value[2])*b;this.value[3]+=
(a.w-this.value[3])*b;return this};b.prototype.clone=function(){return new GLOW.Vector4(this.value[0],this.value[1],this.value[2],this.value[3])};return b}();
GLOW.Matrix3=function(){function b(){this.value=new Float32Array(9);this.identity()}b.prototype.set=function(a,b,e,d,f,h,g,i,j){this.value[0]=a;this.value[4]=b;this.value[8]=e;this.value[1]=d;this.value[5]=f;this.value[9]=h;this.value[2]=g;this.value[6]=i;this.value[10]=j;return this};b.prototype.identity=function(){this.set(1,0,0,0,1,0,0,0,1);return this};return b}();
GLOW.Matrix4=function(){function b(){this.value=new Float32Array(16);this.rotation=new GLOW.Vector3;this.position=new GLOW.Vector3;this.columnX=new GLOW.Vector3;this.columnY=new GLOW.Vector3;this.columnZ=new GLOW.Vector3;this.identity()}b.prototype.set=function(a,b,e,d,f,h,g,i,j,k,l,n,o,r,p,q){this.value[0]=a;this.value[4]=b;this.value[8]=e;this.value[12]=d;this.value[1]=f;this.value[5]=h;this.value[9]=g;this.value[13]=i;this.value[2]=j;this.value[6]=k;this.value[10]=l;this.value[14]=n;this.value[3]=
o;this.value[7]=r;this.value[11]=p;this.value[15]=q;return this};b.prototype.identity=function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this};b.prototype.copy=function(a){a=a.value;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this};b.prototype.lookAt=function(a,b){var e=GLOW.Matrix4.tempVector3A,d=GLOW.Matrix4.tempVector3B,f=GLOW.Matrix4.tempVector3C,h=this.getPosition();h.value[0]=this.value[12];h.value[1]=this.value[13];h.value[2]=
this.value[14];f.sub(h,a).normalize();f.length()===0&&(f.value[3]=1);e.cross(b,f).normalize();e.length()===0&&(f.value[0]+=1.0E-4,e.cross(b,f).normalize());d.cross(f,e).normalize();e=e.value;d=d.value;f=f.value;this.value[0]=e[0];this.value[4]=d[0];this.value[8]=f[0];this.value[1]=e[1];this.value[5]=d[1];this.value[9]=f[1];this.value[2]=e[2];this.value[6]=d[2];this.value[10]=f[2];return this};b.prototype.multiplyVector3=function(a){var b=a.value[0],e=a.value[1],d=a.value[2],f=1/(this.value[3]*b+this.value[7]*
e+this.value[11]*d+this.value[15]);a.value[0]=(this.value[0]*b+this.value[4]*e+this.value[8]*d+this.value[12])*f;a.value[1]=(this.value[1]*b+this.value[5]*e+this.value[9]*d+this.value[13])*f;a.value[2]=(this.value[2]*b+this.value[6]*e+this.value[10]*d+this.value[14])*f;return a};b.prototype.multiplyVector4=function(a){var b=a.value[0],e=a.value[1],d=a.value[2],f=a.value[3];a.value[0]=this.value[0]*b+this.value[4]*e+this.value[8]*d+this.value[12]*f;a.value[1]=this.value[1]*b+this.value[5]*e+this.value[9]*
d+this.value[13]*f;a.value[2]=this.value[2]*b+this.value[6]*e+this.value[10]*d+this.value[14]*f;a.value[3]=this.value[3]*b+this.value[7]*e+this.value[11]*d+this.value[15]*f;return a};b.prototype.rotateAxis=function(a){var b=a.value[0],e=a.value[1],d=a.value[2];a.value[0]=b*this.value[0]+e*this.value[4]+d*this.value[8];a.value[1]=b*this.value[1]+e*this.value[5]+d*this.value[9];a.value[2]=b*this.value[2]+e*this.value[6]+d*this.value[10];a.normalize();return a};b.prototype.crossVector=function(a){var b=
GLOW.Vector4(),e=a.value[0],d=a.value[1],f=a.value[2],a=a.value[3];b.value[0]=this.value[0]*e+this.value[4]*d+this.value[8]*f+this.value[12]*a;b.value[1]=this.value[1]*e+this.value[5]*d+this.value[9]*f+this.value[13]*a;b.value[2]=this.value[2]*e+this.value[6]*d+this.value[10]*f+this.value[14]*a;b.value[3]=a?this.value[3]*e+this.value[7]*d+this.value[11]*f+this.value[15]*a:1;return b};b.prototype.multiply=function(a,b){var a=a.value,b=b.value,e=a[0],d=a[4],f=a[8],h=a[12],g=a[1],i=a[5],j=a[9],k=a[13],
l=a[2],n=a[6],o=a[10],r=a[14],p=a[3],q=a[7],s=a[11],t=a[15],u=b[0],v=b[4],w=b[8],x=b[12],y=b[1],z=b[5],A=b[9],B=b[13],C=b[2],D=b[6],E=b[10],F=b[14];this.value[0]=e*u+d*y+f*C;this.value[4]=e*v+d*z+f*D;this.value[8]=e*w+d*A+f*E;this.value[12]=e*x+d*B+f*F+h;this.value[1]=g*u+i*y+j*C;this.value[5]=g*v+i*z+j*D;this.value[9]=g*w+i*A+j*E;this.value[13]=g*x+i*B+j*F+k;this.value[2]=l*u+n*y+o*C;this.value[6]=l*v+n*z+o*D;this.value[10]=l*w+n*A+o*E;this.value[14]=l*x+n*B+o*F+r;this.value[3]=p*u+q*y+s*C;this.value[7]=
p*v+q*z+s*D;this.value[11]=p*w+q*A+s*E;this.value[15]=p*x+q*B+s*F+t;return this};b.prototype.multiplySelf=function(a){this.multiply(m,a);return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[4]*=a;this.value[8]*=a;this.value[12]*=a;this.value[1]*=a;this.value[5]*=a;this.value[9]*=a;this.value[13]*=a;this.value[2]*=a;this.value[6]*=a;this.value[10]*=a;this.value[14]*=a;this.value[3]*=a;this.value[7]*=a;this.value[11]*=a;this.value[15]*=a;return this};b.prototype.determinant=
function(){var a=this.value[0],b=this.value[4],e=this.value[8],d=this.value[12],f=this.value[1],h=this.value[5],g=this.value[9],i=this.value[13],j=this.value[2],k=this.value[6],l=this.value[10],n=this.value[14],o=this.value[3],r=this.value[7],p=this.value[11],q=this.value[15];return d*g*k*o-e*i*k*o-d*h*l*o+b*i*l*o+e*h*n*o-b*g*n*o-d*g*j*r+e*i*j*r+d*f*l*r-a*i*l*r-e*f*n*r+a*g*n*r+d*h*j*p-b*i*j*p-d*f*k*p+a*i*k*p+b*f*n*p-a*h*n*p-e*h*j*q+b*g*j*q+e*f*k*q-a*g*k*q-b*f*l*q+a*h*l*q};b.prototype.transpose=function(){var a;
a=this.value[1];this.value[1]=this.value[4];this.value[4]=a;a=this.value[2];this.value[2]=this.value[8];this.value[8]=a;a=this.value[6];this.value[6]=this.value[9];this.value[9]=a;a=this.value[3];this.value[3]=this.value[12];this.value[12]=a;a=this.value[7];this.value[7]=this.value[13];this.value[13]=a;a=this.value[11];this.value[11]=this.value[14];this.value[11]=a;return this};b.prototype.clone=function(){var a=new GLOW.Matrix4;a.value=new Float32Array(m);return a};b.prototype.setPosition=function(a,
b,e){this.value[12]=a;this.value[13]=b;this.value[14]=e;return this};b.prototype.addPosition=function(a,b,e){this.value[12]+=a;this.value[13]+=b;this.value[14]+=e};b.prototype.setRotation=function(a,b,e){this.rotation.set(a,b,e);var d=Math.cos(a),a=Math.sin(a),f=Math.cos(b),b=Math.sin(b),h=Math.cos(e),e=Math.sin(e),g=d*b,i=a*b;this.value[0]=f*h;this.value[4]=-f*e;this.value[8]=b;this.value[1]=i*h+d*e;this.value[5]=-i*e+d*h;this.value[9]=-a*f;this.value[2]=-g*h+a*e;this.value[6]=g*e+a*h;this.value[10]=
d*f;return this};b.prototype.addRotation=function(a,b,e){this.rotation.value[0]+=a;this.rotation.value[1]+=b;this.rotation.value[2]+=e;this.setRotation(this.rotation.value[0],this.rotation.value[1],this.rotation.value[2])};b.prototype.getPosition=function(){this.position.set(this.value[12],this.value[13],this.value[14]);return this.position};b.prototype.getColumnX=function(){this.columnX.set(this.value[0],this.value[1],this.value[2]);return this.columnX};b.prototype.getColumnY=function(){this.columnY.set(this.value[4],
this.value[5],this.value[6]);return this.columnY};b.prototype.getColumnZ=function(){this.columnZ.set(this.value[8],this.value[9],this.value[10]);return this.columnZ};b.prototype.scale=function(a,b,e){var d;b!==void 0&&e!==void 0?d=a:(d=a.value[0],b=a.value[1],e=a.value[2]);this.value[0]*=d;this.value[4]*=b;this.value[8]*=e;this.value[1]*=d;this.value[5]*=b;this.value[9]*=e;this.value[2]*=d;this.value[6]*=b;this.value[10]*=e;this.value[3]*=d;this.value[7]*=b;this.value[11]*=e;return this};return b}();
GLOW.Matrix4.makeInverse=function(b,a){a===void 0&&(a=new GLOW.Matrix4);var c=b.value,e=a.value,d=c[0],f=c[4],h=c[8],g=c[12],i=c[1],j=c[5],k=c[9],l=c[13],n=c[2],o=c[6],r=c[10],p=c[14],q=c[3],s=c[7],t=c[11],c=c[15];e[0]=k*p*s-l*r*s+l*o*t-j*p*t-k*o*c+j*r*c;e[1]=l*r*q-k*p*q-l*n*t+i*p*t+k*n*c-i*r*c;e[2]=j*p*q-l*o*q+l*n*s-i*p*s-j*n*c+i*o*c;e[3]=k*o*q-j*r*q-k*n*s+i*r*s+j*n*t-i*o*t;e[4]=g*r*s-h*p*s-g*o*t+f*p*t+h*o*c-f*r*c;e[5]=h*p*q-g*r*q+g*n*t-d*p*t-h*n*c+d*r*c;e[6]=g*o*q-f*p*q-g*n*s+d*p*s+f*n*c-d*o*c;
e[7]=f*r*q-h*o*q+h*n*s-d*r*s-f*n*t+d*o*t;e[8]=h*l*s-g*k*s+g*j*t-f*l*t-h*j*c+f*k*c;e[9]=g*k*q-h*l*q-g*i*t+d*l*t+h*i*c-d*k*c;e[10]=h*l*q-g*j*q+g*i*s-d*l*s-f*i*c+d*j*c;e[11]=h*j*q-f*k*q-h*i*s+d*k*s+f*i*t-d*j*t;e[12]=g*k*o-h*l*o-g*j*r+f*l*r+h*j*p-f*k*p;e[13]=h*l*n-g*k*n+g*i*r-d*l*r-h*i*p+d*k*p;e[14]=g*j*n-f*l*n-g*i*o+d*l*o+f*i*p-d*j*p;e[15]=f*k*n-h*j*n+h*i*o-d*k*o-f*i*r+d*j*r;a.multiplyScalar(1/b.determinant());return a};
GLOW.Matrix4.makeFrustum=function(b,a,c,e,d,f){var h,g;h=new GLOW.Matrix4;g=h.value;g[0]=2*d/(a-b);g[4]=0;g[8]=(a+b)/(a-b);g[12]=0;g[1]=0;g[5]=2*d/(e-c);g[9]=(e+c)/(e-c);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+d)/(f-d);g[14]=-2*f*d/(f-d);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return h};GLOW.Matrix4.makeProjection=function(b,a,c,e){var d,b=c*Math.tan(b*Math.PI/360);d=-b;return GLOW.Matrix4.makeFrustum(d*a,b*a,d,b,c,e)};
GLOW.Matrix4.makeOrtho=function(b,a,c,e,d,f){var h,g,i,j,k;h=GLOW.Matrix4();i=a-b;j=c-e;k=f-d;g=h.value;g[0]=2/i;g[4]=0;g[8]=0;g[12]=-((a+b)/i);g[1]=0;g[5]=2/j;g[9]=0;g[13]=-((c+e)/j);g[2]=0;g[6]=0;g[10]=-2/k;g[14]=-((f+d)/k);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return h};GLOW.Matrix4.tempVector3A=new GLOW.Vector3;GLOW.Matrix4.tempVector3B=new GLOW.Vector3;GLOW.Matrix4.tempVector3C=new GLOW.Vector3;GLOW.Matrix4.tempVector3D=new GLOW.Vector3;
GLOW.Geometry={randomVector3Array:function(b,a){var a=a!==void 0?a:1,c,e=[],d=a*2;for(c=0;c<b;c++)e.push(GLOW.Vector3(Math.random()*d-a,Math.random()*d-a,Math.random()*d-a));return e},elements:function(b){var a=0,c,e=new Uint16Array(b*3);for(c=0;c<b;c++)e[a]=a++,e[a]=a++,e[a]=a++;return e},faceNormals:function(b,a){var c=new Float32Array(b.length),e,d=a.length,f,h,g,i=new GLOW.Vector3,j=new GLOW.Vector3,k=new GLOW.Vector3,l=new GLOW.Vector3;for(e=0;e<d;)f=a[e++]*3,h=a[e++]*3,g=a[e++]*3,i.set(b[f+
0],b[f+1],b[f+2]),j.set(b[h+0],b[h+1],b[h+2]),k.set(b[g+0],b[g+1],b[g+2]),j.subSelf(i),k.subSelf(i),l.cross(k,j).normalize(),c[f+0]=l.value[0],c[f+1]=l.value[1],c[f+2]=l.value[2],c[h+0]=l.value[0],c[h+1]=l.value[1],c[h+2]=l.value[2],c[g+0]=l.value[0],c[g+1]=l.value[1],c[g+2]=l.value[2];return c}};
GLOW.Geometry.Cube={vertices:function(b){var a=new Float32Array(72),c=0,b=b!==void 0?b*0.5:5;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=+b;
a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;return a},elements:function(){var b=new Uint16Array(36),a=0;b[a++]=0;b[a++]=1;b[a++]=2;b[a++]=0;b[a++]=2;b[a++]=3;b[a++]=4;b[a++]=5;b[a++]=6;b[a++]=4;b[a++]=6;b[a++]=7;b[a++]=8;b[a++]=9;b[a++]=
10;b[a++]=8;b[a++]=10;b[a++]=11;b[a++]=12;b[a++]=13;b[a++]=14;b[a++]=12;b[a++]=14;b[a++]=15;b[a++]=16;b[a++]=17;b[a++]=18;b[a++]=16;b[a++]=18;b[a++]=19;b[a++]=20;b[a++]=21;b[a++]=22;b[a++]=20;b[a++]=22;b[a++]=23;return b},uvs:function(){var b=new Float32Array(48),a=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;
b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;return b}};
GLOW.Geometry.Plane={vertices:function(b){var a=new Float32Array(12),c=0,b=b!==void 0?b*0.5:1;a[c++]=+b;a[c++]=-b;a[c++]=0;a[c++]=+b;a[c++]=+b;a[c++]=0;a[c++]=-b;a[c++]=+b;a[c++]=0;a[c++]=-b;a[c++]=-b;a[c++]=0;return a},elements:function(){var b=new Uint16Array(6),a=0;b[a++]=0;b[a++]=1;b[a++]=2;b[a++]=0;b[a++]=2;b[a++]=3;return b},uvs:function(){var b=new Float32Array(8),a=0;b[a++]=1;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=1;b[a++]=0;b[a++]=0;return b}};
GLOW.Node=function(b){this.localMatrix=new GLOW.Matrix4;this.globalMatrix=new GLOW.Matrix4;this.viewMatrix=new GLOW.Matrix4;this.useXYZStyleTransform=!1;this.position={x:0,y:0,z:0};this.rotation={x:0,y:0,z:0};this.scale={x:1,y:1,z:1};this.children=[];this.parent=void 0;if(b)this.shader=b,this.draw=b.draw};
GLOW.Node.prototype.update=function(b,a){this.useXYZStyleTransform&&(this.localMatrix.setPosition(this.position.x,this.position.y,this.position.z),this.localMatrix.setRotation(this.rotation.x,this.rotation.y,this.rotation.z),this.localMatrix.scale(this.scale.x,this.scale.y,this.scale.z));b?this.globalMatrix.multiply(b,this.localMatrix):this.globalMatrix.copy(this.localMatrix);a&&this.viewMatrix.multiply(a,this.globalMatrix);var c,e=this.children.length;for(c=0;c<e;c++)this.children[c].update(this.globalMatrix,
a);return this};GLOW.Node.prototype.addChild=function(b){if(this.children.indexOf(b)===-1)this.children.push(b),b.parent&&b.parent.removeChild(b),b.parent=this;return this};GLOW.Node.prototype.removeChild=function(b){var a=this.children.indexOf(b);if(a!==-1)this.children.splice(1,a),b.parent=void 0;return this};
GLOW.Camera=function(b){GLOW.Node.call(this);var b=b!==void 0?b:{},a=b.fov!==void 0?b.fov:40,c=b.aspect!==void 0?b.aspect:window.innerWidth/window.innerHeight,e=b.near!==void 0?b.near:0.1,d=b.far!==void 0?b.far:1E4;this.useTarget=b.useTarget!==void 0?b.useTarget:!0;this.projection=GLOW.Matrix4.makeProjection(a,c,e,d);this.inverse=new GLOW.Matrix4;this.target=new GLOW.Vector3(0,0,-100);this.up=new GLOW.Vector3(0,1,0);this.update()};GLOW.Camera.prototype=new GLOW.Node;
GLOW.Camera.prototype.constructor=GLOW.Camera;GLOW.Camera.prototype.supr=GLOW.Node.prototype;
GLOW.Camera.prototype.update=function(b,a){this.useXYZStyleTransform?(this.localMatrix.setPosition(this.position.x,this.position.y,this.position.z),this.useTarget?this.localMatrix.lookAt(this.target,this.up):this.localMatrix.setRotation(this.rotation.x,this.rotation.y,this.rotation.z),this.localMatrix.scale(this.scale.x,this.scale.y,this.scale.z)):this.useTarget&&this.localMatrix.lookAt(this.target,this.up);b?this.globalMatrix.multiply(b,this.localMatrix):this.globalMatrix.copy(this.localMatrix);
GLOW.Matrix4.makeInverse(this.globalMatrix,this.inverse);var c,e=this.children.length;for(c=0;c<e;c++)this.children[c].update(this.globalMatrix,a)};GLOW.defaultCamera=new GLOW.Camera;
